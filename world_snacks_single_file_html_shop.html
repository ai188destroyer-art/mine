<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>World Snacks — Candy & Snacks from Around the World</title>
  <style>
    :root{--accent:#ff7a59;--muted:#6b7280;--card:#ffffff;--bg:#f5f7fb}
    *{box-sizing:border-box}html,body{height:100%;margin:0;font-family:Inter, Roboto, system-ui, -apple-system, "Segoe UI", Arial}
    body{background:var(--bg);color:#111}
    header{background:linear-gradient(90deg,var(--accent),#ffb86b);color:#fff;padding:18px 20px;display:flex;align-items:center;justify-content:space-between}
    header h1{margin:0;font-size:18px}
    header p{margin:0;font-size:13px;opacity:.95}

    .container{max-width:1100px;margin:20px auto;padding:0 16px}
    .controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:16px}
    .controls input[type=search],.controls select{padding:10px 12px;border-radius:10px;border:1px solid #e6e9ef;background:#fff}
    .btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(255,255,255,.12)}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(10,10,20,.06);display:flex;flex-direction:column;gap:10px}
    .card img{width:100%;height:140px;object-fit:cover;border-radius:8px}
    .meta{display:flex;justify-content:space-between;align-items:center}
    .meta h3{margin:0;font-size:16px}
    .meta span{font-size:13px;color:var(--muted)}
    .desc{font-size:13px;color:var(--muted);min-height:36px}
    .price{font-weight:700}

    footer{margin:30px 0;text-align:center;color:var(--muted)}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(3,6,18,.45);display:none;align-items:center;justify-content:center;padding:20px}
    .modal{background:#fff;padding:18px;border-radius:12px;max-width:640px;width:100%;box-shadow:0 18px 40px rgba(10,10,20,.2)}
    form .row{display:flex;gap:10px;margin-bottom:10px}
    form label{font-size:13px;color:#333;margin-bottom:6px;display:block}
    form input[type=text],form textarea,form input[type=number],form select{width:100%;padding:9px;border-radius:8px;border:1px solid #e7e9ef}
    textarea{min-height:80px}
    .form-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}

    /* admin area notice */
    .hint{font-size:13px;color:var(--muted)}

    @media (max-width:560px){header{flex-direction:column;gap:8px;align-items:flex-start} .card img{height:120px}}
  </style>
</head>
<body>
  <header>
    <div>
      <h1>World Snacks</h1>
      <p>Buy candy & snacks from around the world — demo single-file store (editable)</p>
    </div>
    <div>
      <small>Local demo — changes are saved to your browser (localStorage)</small>
    </div>
  </header>

  <main class="container">
    <section class="controls">
      <input id="search" type="search" placeholder="Search by name or country" />
      <select id="countryFilter">
        <option value="">All countries</option>
      </select>
      <select id="sort">
        <option value="popular">Sort: Popular</option>
        <option value="price-asc">Price: Low → High</option>
        <option value="price-desc">Price: High → Low</option>
      </select>
      <div style="margin-left:auto;display:flex;gap:8px">
        <button id="openAdd" class="btn">+ Add product</button>
        <button id="resetDemo" class="btn" style="background:#333">Reset demo</button>
      </div>
    </section>

    <section id="products" class="grid" aria-live="polite"></section>

    <p class="hint">Tip: Click a product's "Edit" button to change its details. Images can be any web URL. Your edits are stored in this browser only.</p>

    <footer>
      <small>Made for you — edit the HTML/CSS/JS, add server-side checkout later.</small>
    </footer>
  </main>

  <!-- modal for add/edit -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true">
      <h2 id="modalTitle">Add product</h2>
      <form id="productForm">
        <div class="row">
          <div style="flex:1">
            <label for="name">Name</label>
            <input id="name" required type="text" />
          </div>
          <div style="width:140px">
            <label for="price">Price (USD)</label>
            <input id="price" required type="number" step="0.01" min="0" />
          </div>
        </div>
        <div class="row">
          <div style="flex:1">
            <label for="country">Country</label>
            <input id="country" placeholder="e.g. Japan" type="text" />
          </div>
          <div style="width:140px">
            <label for="pop">Popularity</label>
            <select id="pop">
              <option value="3">High</option>
              <option value="2">Medium</option>
              <option value="1">Low</option>
            </select>
          </div>
        </div>

        <label for="image">Image URL</label>
        <input id="image" type="text" placeholder="https://...jpg" />

        <label for="desc">Short description</label>
        <textarea id="desc"></textarea>

        <div class="form-actions">
          <button type="button" id="cancel" class="btn" style="background:#999">Cancel</button>
          <button type="submit" class="btn">Save product</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    /* Single-file demo shop with editable product data stored in localStorage.
       - Add, edit, delete products from the UI
       - Search, filter by country, sort
       - This is front-end only. To make it live you'll need a back end + payment.
    */

    const DEMO_KEY = 'world-snacks.products.v1';

    const demoProducts = [
      {id:generateId(),name:'Pocky (Chocolate)',country:'Japan',price:2.5,image:'https://images.unsplash.com/photo-1602530082411-6ec7f0d9a6f8?q=80&w=800&auto=format&fit=crop&ixlib=rb-4.0.3&s=58c8b3c9d0fe1fef3f3b3a5b3f6f6f6a',desc:'Crunchy biscuit sticks coated in chocolate. Classic Japanese treat.',pop:3},
      {id:generateId(),name:'Haribo Goldbears',country:'Germany',price:1.99,image:'https://images.unsplash.com/photo-1610962918388-6b8b3b0e2b56?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=0d9a2f4c3a1f4b4c',desc:'Chewy gummy bears in mixed fruit flavours.',pop:3},
      {id:generateId(),name:'Dulce de Leche Bonbons',country:'Argentina',price:3.5,image:'https://images.unsplash.com/photo-1599785209799-7d2a5f0a7d1e?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=a1b2c3d4e5f6',desc:'Creamy dulce de leche candies.',pop:2},
      {id:generateId(),name:'Tim Tam',country:'Australia',price:4.2,image:'https://images.unsplash.com/photo-1515442261605-65987759b0d9?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=b1c2d3e4f5a6',desc:'Chocolate-coated biscuits — dunk in tea!',pop:3},
    ];

    // elements
    const productsEl = document.getElementById('products');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const productForm = document.getElementById('productForm');
    const modalTitle = document.getElementById('modalTitle');
    const searchInput = document.getElementById('search');
    const countryFilter = document.getElementById('countryFilter');
    const sortSelect = document.getElementById('sort');
    const openAdd = document.getElementById('openAdd');
    const cancelBtn = document.getElementById('cancel');
    const resetDemo = document.getElementById('resetDemo');

    let products = loadProducts();
    let editingId = null;

    renderFilterOptions();
    renderProducts();

    // events
    searchInput.addEventListener('input', renderProducts);
    countryFilter.addEventListener('change', renderProducts);
    sortSelect.addEventListener('change', renderProducts);
    openAdd.addEventListener('click', ()=>openModal());
    cancelBtn.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', (e)=>{ if(e.target===modalBackdrop) closeModal(); });
    productForm.addEventListener('submit', onSaveProduct);
    resetDemo.addEventListener('click', ()=>{ if(confirm('Reset demo data? This will erase your edits.')){ products = demoProducts.slice(); saveProducts(); renderFilterOptions(); renderProducts(); } });

    function generateId(){ return 'p_'+Math.random().toString(36).slice(2,9); }

    function loadProducts(){
      try{
        const raw = localStorage.getItem(DEMO_KEY);
        if(!raw) { localStorage.setItem(DEMO_KEY, JSON.stringify(demoProducts)); return demoProducts.slice(); }
        return JSON.parse(raw);
      }catch(e){console.error('load error',e); return demoProducts.slice();}
    }

    function saveProducts(){ localStorage.setItem(DEMO_KEY, JSON.stringify(products)); }

    function renderFilterOptions(){
      const countries = Array.from(new Set(products.map(p=>p.country).filter(Boolean))).sort();
      countryFilter.innerHTML = '<option value="">All countries</option>' + countries.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join('');
    }

    function renderProducts(){
      const q = searchInput.value.trim().toLowerCase();
      const country = countryFilter.value;
      const sort = sortSelect.value;

      let list = products.slice();
      if(q){ list = list.filter(p=> (p.name||'').toLowerCase().includes(q) || (p.country||'').toLowerCase().includes(q) || (p.desc||'').toLowerCase().includes(q)); }
      if(country){ list = list.filter(p => p.country === country); }

      if(sort==='price-asc') list.sort((a,b)=>a.price - b.price);
      else if(sort==='price-desc') list.sort((a,b)=>b.price - a.price);
      else list.sort((a,b)=> (b.pop||0)-(a.pop||0));

      if(list.length===0){ productsEl.innerHTML = '<p style="grid-column:1/-1;color:var(--muted)">No products match.</p>'; return; }

      productsEl.innerHTML = list.map(p=>`
        <article class="card" data-id="${p.id}">
          <img src="${escapeAttr(p.image||placeholder(p.name))}" alt="${escapeAttr(p.name)}" onerror="this.src='https://via.placeholder.com/400x300?text=No+image'"/>
          <div class="meta">
            <h3>${escapeHtml(p.name)}</h3>
            <span class="price">$${Number(p.price).toFixed(2)}</span>
          </div>
          <div class="desc">${escapeHtml(p.desc||'')}</div>
          <div style="display:flex;gap:8px;justify-content:space-between;align-items:center">
            <small style="color:var(--muted)">${escapeHtml(p.country||'—')}</small>
            <div style="display:flex;gap:6px">
              <button class="btn" onclick="editProduct('${p.id}')">Edit</button>
              <button class="btn" style="background:#e43;" onclick="deleteProduct('${p.id}')">Delete</button>
            </div>
          </div>
        </article>
      `).join('');
    }

    // helper placeholders and escaping
    function placeholder(name){ return 'https://via.placeholder.com/640x400?text='+encodeURIComponent(name||'Snack'); }
    function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>\"]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }
    function escapeAttr(s){ return escapeHtml(s).replace(/'/g,'&#39;'); }

    // expose functions to window for inline onclick usage
    window.editProduct = function(id){ const p = products.find(x=>x.id===id); if(!p) return alert('Product not found'); openModal(p); }
    window.deleteProduct = function(id){ if(!confirm('Delete product?')) return; products = products.filter(p=>p.id!==id); saveProducts(); renderFilterOptions(); renderProducts(); }

    function openModal(product=null){
      editingId = product ? product.id : null;
      modalTitle.textContent = product ? 'Edit product' : 'Add product';
      document.getElementById('name').value = product?.name || '';
      document.getElementById('price').value = product?.price ?? '';
      document.getElementById('country').value = product?.country || '';
      document.getElementById('image').value = product?.image || '';
      document.getElementById('desc').value = product?.desc || '';
      document.getElementById('pop').value = product?.pop || 2;
      modalBackdrop.style.display = 'flex';
    }

    function closeModal(){ modalBackdrop.style.display='none'; editingId=null; productForm.reset(); }

    function onSaveProduct(e){
      e.preventDefault();
      const data = {
        id: editingId || generateId(),
        name: document.getElementById('name').value.trim()||'Untitled',
        price: parseFloat(document.getElementById('price').value)||0,
        country: document.getElementById('country').value.trim(),
        image: document.getElementById('image').value.trim(),
        desc: document.getElementById('desc').value.trim(),
        pop: Number(document.getElementById('pop').value)||2,
      };

      if(editingId){
        products = products.map(p=> p.id===editingId ? {...p,...data} : p);
      }else{
        products.push(data);
      }
      saveProducts(); renderFilterOptions(); renderProducts(); closeModal();
    }

    // initialize demo if empty
    if(!localStorage.getItem(DEMO_KEY)) { localStorage.setItem(DEMO_KEY, JSON.stringify(demoProducts)); products = demoProducts.slice(); }

    // expose a small API for advanced users editing this file
    window.WorldSnacks = {
      list: ()=>products,
      add: (p)=>{ p.id = p.id || generateId(); products.push(p); saveProducts(); renderFilterOptions(); renderProducts(); },
      clear: ()=>{ products=[]; saveProducts(); renderFilterOptions(); renderProducts(); }
    };

  </script>
</body>
</html>
